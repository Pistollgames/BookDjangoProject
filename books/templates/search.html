{% extends 'base.html' %}
{% block title %}Поиск книг{% endblock %}
{% block content %}
<h1>Поиск книг в Google Books</h1>
<form method="get">
    <input type="text" name="q" value="{{ query }}" placeholder="Введите название книги или автора...">
    <button type="submit">Искать</button>
</form>
{% if query %}
    <h2>Результаты для "{{ query }}":</h2>
    {% if books %}
        {% for book in books %}
        <div class="book">
            <h3>{{ book.title }}</h3>
            <p><strong>Автор:</strong> {{ book.author }}</p>
            <p class="description">{{ book.description|truncatechars:200 }}</p>
            <p><strong>Страниц:</strong> {{ book.pages }}</p>
            {% if user.is_authenticated %}
            <form method="post" action="{% url 'add_book' %}">
                {% csrf_token %}
                <input type="hidden" name="title" value="{{ book.title }}">
                <input type="hidden" name="author" value="{{ book.author }}">
                <input type="hidden" name="pages" value="{{ book.pages }}">
                <input type="hidden" name="description" value="{{ book.description }}">
                <button type="submit">Добавить в мои книги</button>
            </form>
            {% else %}
            <p><a href="{% url 'login' %}">Войдите</a>, чтобы добавить книгу в свою коллекцию</p>
            {% endif %}
        </div>
        {% endfor %}
    {% else %}
        <p>Книги не найдены. Попробуйте другой запрос.</p>
    {% endif %}
{% else %}
    <p>Введите запрос в поле выше для поиска книг.</p>
{% endif %}
{% endblock %}